<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Experimentos</title>
    <link rel="stylesheet" href="styles/styles.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Dashboard de Experimentos</h1>
    <label for="experiment-select">Selecciona un experimento:</label>
    <select id="experiment-select" onchange="loadExperimentData()">
        <option value="">Seleccione un experimento</option>
    </select>
    <div id="chart"></div>

    <script src="scripts/app.js"></script>
</body>
<script>
// Función para cargar la lista de archivos .txt de la carpeta "data"
async function loadExperimentList() {
    const response = await fetch('data/');
    const text = await response.text();
    const parser = new DOMParser();
    const doc = parser.parseFromString(text, 'text/html');
    const fileList = Array.from(doc.querySelectorAll('a')).map(link => link.href).filter(file => file.endsWith('.txt'));

    const select = document.getElementById('experiment-select');
    fileList.forEach(file => {
        const option = document.createElement('option');
        option.value = file;
        option.textContent = file.replace('data/', '').replace('.txt', '');
        select.appendChild(option);
    });
}

// Función para cargar los datos de un experimento y generar la gráfica
async function loadExperimentData() {
    const select = document.getElementById('experiment-select');
    const experimentFile = select.value;

    if (experimentFile) {
        const response = await fetch(experimentFile);
        const data = await response.text();

        const parsedData = parseExperimentData(data);
        plotData(parsedData);
    }
}

// Función para convertir el contenido del archivo .txt a un formato entendible
function parseExperimentData(data) {
    const lines = data.split('\n');
    const legend = lines[0].trim();
    const xValues = [];
    const yValues = [];

    for (let i = 1; i < lines.length; i++) {
        const [x, y] = lines[i].trim().split(/\s+/);
        if (x && y) {
            xValues.push(parseFloat(x));
            yValues.push(parseFloat(y));
        }
    }
    return { legend, xValues, yValues };
}

// Función para graficar los datos usando Plotly
function plotData({ legend, xValues, yValues }) {
    const trace = {
        x: xValues,
        y: yValues,
        mode: 'lines+markers',
        name: legend,
        line: { shape: 'linear' }
    };

    const layout = {
        title: `Gráfico del experimento: ${legend}`,
        xaxis: { title: 'Iteraciones' },
        yaxis: { title: 'Valores' }
    };

    Plotly.newPlot('chart', [trace], layout);
}

// Inicializa el listado de experimentos cuando la página carga
document.addEventListener('DOMContentLoaded', loadExperimentList);
</script>
</html>

